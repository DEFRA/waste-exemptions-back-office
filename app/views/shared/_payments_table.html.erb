<%
  # Default to not showing available amount if not specified
  show_available_amount = local_assigns.fetch(:show_available_amount, false)
%>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <%= render("waste_exemptions_engine/shared/back", back_path: registration_payment_details_path(reference: resource.reference)) %>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-l">
      <%= t("#{translation_prefix}.heading") %>
    </h1>
    <table class="govuk-table">
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th class="govuk-table__header">
            <%= t("#{translation_prefix}.date") %>
          </th>
          <th class="govuk-table__header">
            <%= t("#{translation_prefix}.reference") %>
          </th>
          <th class="govuk-table__header">
            <%= t("#{translation_prefix}.payment_type") %>
          </th>
          <th class="govuk-table__header govuk-table__header--numeric">
            <%= t("#{translation_prefix}.amount") %>
          </th>
          <% if show_available_amount %>
          <th class="govuk-table__header govuk-table__header--numeric">
            <%= t("#{translation_prefix}.available_amount") %>
          </th>
          <% end %>
          <th class="govuk-table__header">
            <%= t("#{translation_prefix}.action") %>
          </th>
        </tr>
      </thead>
      <tbody class="govuk-table__body">
        <% payments.each do |payment| %>
          <tr class="govuk-table__row">
            <td class="govuk-table__cell">
              <%= payment.created_at %>
            </td>
            <td class="govuk-table__cell">
              <%= payment.reference %>
            </td>
            <td class="govuk-table__cell">
              <%= payment.payment_type %>
            </td>
            <td class="govuk-table__cell govuk-table__cell--numeric">
              <%= payment.payment_amount %>
            </td>
            <% if show_available_amount %>
            <td class="govuk-table__cell govuk-table__cell--numeric">
              <%= payment.available_refund_amount %>
            </td>
            <% end %>
            <td class="govuk-table__cell">
              <%= yield payment %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
