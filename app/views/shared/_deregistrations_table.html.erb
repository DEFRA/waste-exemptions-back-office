<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <%= render("waste_exemptions_engine/shared/back", back_path: back_path) %>
    <h1 class="govuk-heading-l"><%= heading %></h1>
    <table class="govuk-table">
      <%#align table caption to the left%>
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th class="govuk-table__header" scope="col"><%= t('deregistrations.deregistrations_table.headers.exemption') %></th>
          <th class="govuk-table__header" scope="col"><%= t('deregistrations.deregistrations_table.headers.deregistered_on') %></th>
          <th class="govuk-table__header" scope="col"><%= t('deregistrations.deregistrations_table.headers.reason') %></th>
          <th class="govuk-table__header" scope="col"><%= t('deregistrations.deregistrations_table.headers.status') %></th>
          <th class="govuk-table__header" scope="col"><%= t('deregistrations.deregistrations_table.headers.deregistered_by') %></th>
        </tr>
      </thead>
      <tbody class="govuk-table__body">
        <% deregistered_exemptions.each do |re| %>
          <tr class="govuk-table__row">
            <td class="govuk-table__cell"><%= re.exemption.code %> &mdash; <%= re.exemption.summary %></td>
            <td class="govuk-table__cell date-nowrap">
              <% if re.deregistered_at.present? %>
                <%= re.deregistered_at.to_formatted_s(:day_month_year) %>
              <% end %>
            </td>
            <td class="govuk-table__cell date-nowrap">
              <% if re.deregistration_message.present? %>
                <%= re.deregistration_message %>
              <% else %>
                <%= t('deregistrations.deregistrations_table.deregistered_via_self_serve_reason') %>
              <% end %>
            </td>
            <td class="govuk-table__cell">
              <% if re.state.present? %>
                <span class="<%= "status-tag-#{re.state}" %>"><%= re.state %></span>
              <% end %>
            </td>
            <td class="govuk-table__cell">
              <% if re.deregistered_by.present? %>
                <%= re.deregistered_by %>
              <% else %>
                <%= t('deregistrations.deregistrations_table.deregistered_by_self') %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
